datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Aluno {
  id            Int    @id @default(autoincrement())
  nome          String
  email         String
  cpf           String
  rg            String
  endereco      String
  login         String
  senha         String
  saldo         Int
  instituicaoId Int

  instituicao Instituicao @relation(fields: [instituicaoId], references: [id])

  transacoes Transacao[]
}

model Transacao {
  id          Int            @id @default(autoincrement())
  numMoedas   Int
  tipo        TipoTransaocao
  data        DateTime
  cupom       String
  alunoId     Int
  empresaId   Int?
  professorId Int?

  aluno     Aluno      @relation(fields: [alunoId], references: [id])
  empresa   Empresa?   @relation(fields: [empresaId], references: [id])
  professor Professor? @relation(fields: [professorId], references: [id])
}

model Professor {
  id            Int    @id @default(autoincrement())
  nome          String
  cpf           String
  saldo         Int
  login         String
  senha         String
  instituicaoId Int

  instituicao Instituicao @relation(fields: [instituicaoId], references: [id])

  transacoes Transacao[]
}

model Empresa {
  id    Int    @id @default(autoincrement())
  nome  String
  login String
  senha String

  vantagens  Vantagem[]
  transacoes Transacao[]
}

model Vantagem {
  id        Int    @id @default(autoincrement())
  descricao String
  foto      String
  preco     Int

  empresaId Int

  empresa Empresa @relation(fields: [empresaId], references: [id])
}

model Instituicao {
  id       Int    @id @default(autoincrement())
  nome     String
  endereco String

  alunos      Aluno[]
  professores Professor[]
}

enum TipoTransaocao {
  TROCA
  ENVIO
  RECEBIMENTO
}
